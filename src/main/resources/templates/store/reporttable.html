<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>门店报表页</title>
    <link th:href="@{https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css}" rel="stylesheet"/>
    <script th:src="@{https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js}"></script>
    <script th:src="@{https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js}"></script>
    <style>
      /*  <!-- td:vertical-align: middle;text-align:center;-->*/
    </style>
    <script>
        <!--填充表头-->
        $(function () {
            var content="";
            $.ajax({
                url:"/report/findAll",
                dataType:"JSON",
                type:"GET",
                success:function (data) {
                    classData=data["classitem"];
                    console.log("classData---->"+classData);
                    store=JSON.parse(data["store"]);
                    console.log("store----->"+store);
                    var str="<tr><th rowspan='3' style=\"vertical-align: middle;text-align:center;\">门店编码</th><th rowspan='3' style=\"vertical-align: middle;text-align:center;\">门店名称</th>";
                    var str1="<tr>";
                    var str2="<tr>";
                    var colArray = new Array();
                    for (var i = 0; i <classData.length ; i++) {
                        var len = 0;
                        for (var j = 0; j <classData[i]. equipNames.length ; j++) {
                            len+=classData[i]. equipNames[j]. itemSet.length;
                        }
                        colArray.push(len);
                    }
                    for (var i = 0; i <classData.length ; i++) {
                        str+="<th style=\"vertical-align: middle;text-align:center;\" colspan='"+colArray[i]+"'>"+classData[i].name+"</th>";
                        for (var j = 0; j <classData[i]. equipNames.length; j++) {
                            str1+="<th style=\"vertical-align: middle;text-align:center;\" colspan='"+classData[i]. equipNames[j]. itemSet.length+"'>"+classData[i]. equipNames[j].name+"</th>"
                            for (var k = 0; k <classData[i]. equipNames[j]. itemSet.length ; k++) {
                                str2+="<th style=\"vertical-align: middle;text-align:center;\">"+classData[i]. equipNames[j]. itemSet[k].name+"</th>";
                            }
                        }
                    }
                    str2+="</tr>";
                    str1+="</tr>";
                    str+="</tr>";
                    str+=str1;
                    str+=str2;
                    $("thead").html(str);
                    for (var i = 0; i <store.length ; i++) {
                        content+="<tr>";
                        content+="<td>"+store[i].storeCode+"</td>";
                        content+="<td>"+store[i].storeName+"</td>";
                        for (var k = 0; k <classData.length; k++) {
                            for (var l = 0; l <classData[k]. equipNames.length ; l++) {
                                for (var m = 0; m <classData[k]. equipNames[l]. itemSet.length ; m++) {
                                    if(store[i].items[classData[k]. equipNames[l]. itemSet[m].name]!=null){
                                        content+="<td>"+store[i].items[classData[k]. equipNames[l]. itemSet[m].name]+"</td>";
                                    }else {
                                        content+="<td>0</td>";
                                    }
                                }
                            }
                        }
                    }
                    content+="</tr>";
                    $("tbody").html(content);
                }

            })
        });
    </script>
</head>
<body>
  <div class="container">
      <table class="table table-bordered" id="myTable" style="text-align: center;">
          <caption>门店设备列表展示</caption>
          <thead></thead>
          <tbody></tbody>
      </table>
  </div>
</body>
</html>